full Python code (the Colab version exported)
